var pageSize=10,courseId=PEP.Resources.CourseId(),lectureId=PEP.Resources.LectureId(),contestId=$("#contestId").val(),resourceId=PEP.Resources.ResourceId();function showSubmissions(e){var t="/profile/submissions/pageSize/"+(pageSize||10)+"/pageFrom/"+e;1==e&&10==pageSize||window.PEP.showLoader(),$.ajax({url:t,dataType:"json",method:"Get",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){$("#submissionsContainer").html(e.data),$(".pageLi").on("click",function(){showSubmissions($(this).attr("index"))}),$("#showSubmissionsPerpage").on("change",function(){pageSize=this.value,showSubmissions(1)}),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}})}function showStats(e){courseId=PEP.Resources.CourseId(),lectureId=PEP.Resources.LectureId(),contestId=$("#contestId").val(),resourceId=PEP.Resources.ResourceId();var t="",o=pageSize||10;contestId&&resourceId?t="/stats/contest/"+contestId+"/resource/"+resourceId+"/pageSize/"+o+"/pageFrom/"+e:contestId?t="/stats/contest/"+contestId+"/pageSize/"+o+"/pageFrom/"+e:courseId&&lectureId&&resourceId?t="/stats/resource/"+resourceId+"/pageSize/"+o+"/pageFrom/"+e:courseId&&lectureId?t="/stats/course/"+courseId+"/lectureId/"+lectureId+"/pageSize/"+o+"/pageFrom/"+e:courseId&&(t="/stats/course/"+courseId+"/pageSize/"+o+"/pageFrom/"+e),1==e&&10==pageSize||window.PEP.showLoader(),$.ajax({url:t,dataType:"json",method:"Get",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){$("#statsContainer").html(e.data),$("#stat"+e.userId).addClass("grey white-text"),$(".pageLi").on("click",function(){showStats($(this).attr("index"))}),$("#showStatsPerpage").on("change",function(){pageSize=this.value,showStats(1)}),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}})}function showPpOrders(e){var t=pageSize||10,o=$("#searchBox").val().trim(),o="/placementprogram/orders/pageSize/"+t+"/pageFrom/"+e+"/filter/"+$("#status-filter").val()+"/searchText/"+o;1==e&&10==pageSize||window.PEP.showLoader(),$.ajax({url:o,dataType:"json",method:"Get",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){function s(e,t,o,s){t={userId:t,type:o,ext:s};let a=o;o.includes("isa")&&(a="isa"+o.split("/")[1]);let r=$("#"+e)[0].querySelector("#"+a);null!=r&&$.ajax({url:"/placementprogram/getSignedUrl",dataType:"json",data:t,method:"POST",success:function(e){e&&("pdf"==s?r.href=e.message:r.src=e.message)},error:function(e){console.log(e)}})}$("#statsContainer").html(e.data),$("#stat"+e.userId).addClass("grey white-text"),$("#searchBox").val(),$(".pageLi").on("click",function(){showPpOrders($(this).attr("index"))}),$("#showOrdersPerpage").on("change",function(){pageSize=this.value,showPpOrders(1)}),window.PEP.hideLoader(),$("select,textarea,i.fa-trash,input,i.fa-check").click(function(e){e.stopPropagation()}),$("#status-filter").change(function(){showPpOrders(1)}),$(".all").each(function(){var e;"application-progress"==(e=$(this).attr("class").split(" ")[0])||"application-submitted"==e||"evaluationTest"==e?$("tr."+e).css("background","#e5f4fd"):"application-rejected"==e?$("tr."+e).css("background","#ffc5c5"):"documents-progress"==e||"documents-submitted"==e?$("tr."+e).css("background","#e5f4fd"):"documents-accepted"==e?$("tr."+e).css("background","e5f4fd"):"documents-rejected"==e?$("tr."+e).css("background","#ffc5c5"):"documents-isaApproved"==e?$("tr."+e).css("background","#c1f7c7"):$("tr."+e).css("background","#e5f4fd")});e=document.querySelectorAll(".modal");M.Modal.init(e),$(".modal.reviewModal").modal({onOpenStart:function(){var e=$(this.el).attr("id"),t=$(this.el).attr("userId"),o=$("#"+e)[0].querySelector("#photo");o&&null==o.src&&(s(e,t,"photo","jpeg"),s(e,t,"panCard","jpeg"),s(e,t,"aadharCardFront","jpeg"),s(e,t,"aadharCardBack","jpeg"),s(e,t,"resume","pdf"),s(e,t,"isa/unsigned","pdf"),s(e,t,"isa/signed","pdf"),s(e,t,"employmentProof1",(o=(o=$("#"+e)[0].querySelector("#employmentProofString").value)?JSON.parse(o):"").employmentProof1),s(e,t,"employmentProof2",o.employmentProof2),s(e,t,"employmentProof3",o.employmentProof3))}}),$(".modal#previewModal").modal({onOpenStart:function(){$(this).css("z-index",1e6)}})},error:function(e){window.PEP.handleException(e)}})}function toggleResourceNav(){$(this).toggleClass("open"),$(".sidenav-res").toggleClass("open")}function getAllModules(){var t=(t=$(".classResourceList.active div")[0]?$(".classResourceList.active div")[0].innerText:"").trim(),o=(o=$(this).attr("lect-id"))||"";$.ajax({url:"/modules",dataType:"json",method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){e&&e.data&&($("#moduleList"+o).empty().append(e.data),$("#moduleList option").filter(function(){return this.text==t}).attr("selected",!0))},error:function(e){window.PEP.handleException(e)}})}function addLecture(){$name=$("#lectureName"),$description=$("#lectureDescription");var e=$("#moduleList option:selected").val(),t=$name.val()?convertNameToCode($name.val()):"",o=$("#lectureIndexes").val().trim();window.PEP.showLoader();o={name:$name.val(),description:$description.val(),courseId:courseId,moduleId:e,code:t,indexes:o};validateLecture(o)?$.ajax({url:"/"+courseId+"/lecture",data:o,dataType:"json",method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){e&&e.message&&(M.toast({html:e.message,classes:"green-text"}),$name.val(""),$description.val(""),$("#lectureModal").modal("close")),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}}):window.PEP.hideLoader()}function validateLecture(e){return e.name?e.description?e.moduleId?e.code?!!e.indexes||(PEP.Component.alert("index can't be empty."),!1):(PEP.Component.alert("code can't be empty."),!1):(PEP.Component.alert("moduleId can't be empty."),!1):(PEP.Component.alert("description can't be empty."),!1):(PEP.Component.alert("name can't be empty."),!1)}function updateLecture(){var t=$(this).attr("id"),e=$("#lectureName"+t).val().trim(),o=$("#lectureDescription"+t).val().trim(),s=$("#lectureIndexes"+t).val().trim(),a=$("#moduleList"+t+" option:selected").val(),r=e?convertNameToCode(e):"",s={name:e,description:o,courseId:courseId,moduleId:a,code:r,indexes:s};window.PEP.showLoader(),validateLecture(s)?$.ajax({url:"/"+courseId+"/lecture/"+t,data:s,dataType:"json",method:"PUT",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){e&&e.message&&(M.toast({html:e.message,classes:"green-text"}),$("#lectureModal"+t).modal("close")),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}}):window.PEP.hideLoader()}function confirmDeletionOfLecture(){var e,t,o=$(this).attr("lect-id");o&&(e=$("#isDeleted"+o).val(),t=0==e?"delete":"remap",PEP.Component.dialog("Are you sure, you wanna "+t+" that lecture?",{title:"Please Confirm",modalType:"modal-fixed-footer",buttons:{close:{className:"red white-text",text:"close",modalClose:!0},confirm:{text:"confirm",modalClose:!0,callback:function(){manageLectureDeletion(o,e=0==e,t)}}}}))}function manageLectureDeletion(e,t,o){window.PEP.showLoader(),$.ajax({url:"/"+courseId+"/lecture/"+t+"/"+e,dataType:"json",method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){e.success&&M.toast({html:"lecture "+o+"d successfully.",classes:"green-text"}),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}})}function filterBatches(){$("option:selected",this);var e=this.value.trim();"all"!=e?($(".coursesCard .courseMasters[value!="+e+"]").parents(".coursesCard").css({display:"none"}),$(".coursesCard .courseMasters[value="+e+"]").parents(".coursesCard").css({display:"block"})):$(".coursesCard").css({display:"block"})}function convertNameToCode(e){return e.replace(/\s/g,"-").replace("---","-").toLowerCase()}function getAllCourseMasters(){window.PEP.showLoader(),$.ajax({url:"/getCourseMasters",dataType:"json",method:"get",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){e&&e.data&&$("#batches").empty().append(e.data),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}})}function submitReview(){var e=$("#reviewerName").val(),t=$("#reviewText").val(),o=$(".rate [name='rate']"),s=0;for(i=0;i<o.length;i++)if(1==o[i].checked){s=o[i].value;break}t={reviewerName:e,reviewText:t,starRating:s};window.PEP.showLoader(),$.ajax({url:"/userReviews",dataType:"json",method:"post",data:t,headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){e.success&&(e=e.message,M.toast({html:e,classes:"green-text"})),$("#reviewModal").modal("close"),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}})}function getUserReviews(){window.PEP.showLoader(),$.ajax({url:"/userReviews",dataType:"json",method:"get",headers:{"X-Requested-With":"XMLHttpRequest"},success:function(e){$(".userReviews").empty().append(e.data),window.PEP.hideLoader()},error:function(e){window.PEP.handleException(e)}})}function redirectToNados(){var e,t;$("input[name=nadosSlug]").val()&&(PEP.showNadosLoader(),e=5,t=setInterval(function(){e--,$(".timmer-nados").html("in "+e+" sec"),0==e&&clearInterval(t)},1e3),setTimeout(()=>{window.location.href="https://nados.io/question/"+$("input[name=nadosSlug]").val()},5e3))}$toggleResourceNav=$("#toggleResourceNav"),$("#searchBox").keyup(function(){showPpOrders(1)}),$(document).ready(function(){$("#batches")[0]&&getAllCourseMasters(),$toggleResourceNav.on("click",toggleResourceNav),$(".getallModules").on("click",getAllModules),$(".manageLectureDeletion").on("click",confirmDeletionOfLecture),$(".frmManageLecture").on("click",".addLecture",addLecture),$(".frmManageLecture").on("click",".updateLecture",updateLecture),$(".batchFilter-dropdown").on("change",filterBatches),$(".submitReview").on("click",submitReview)});